package org.superl.exchange.CBitmexTrade.core;/*    CBitmexKline    Created by superl on 2018/5/23.                                                                      00000                                                                           00000                                                                           00000           00000000    00000  00000  00000000000     00000000    000000000 00000          00000000000  00000  00000  000000000000   00000000000  000000000 00000          00000  000   00000  00000  000000 00000  000000 00000  00000000  00000          000000000    00000  00000  00000   0000  0000000000000 000000    00000           0000000000  00000  00000  00000   00000 0000000000000 00000     00000              0000000  00000  00000  00000   00000 00000         00000     00000          00000  0000  000000000000  000000000000  000000000000  00000     00000          00000000000  000000000000  000000000000   00000000000  00000     00000           000000000   0000000000    00000000000     00000000    00000     00000                                     00000                                                                           00000                 Team:bbs.nepenthes.cn                                       00000                                           */import lombok.extern.log4j.Log4j;import org.superl.exchange.CBitmexTrade.beans.TradeData;import org.superl.exchange.CBitmexTrade.utils.MysqlDB;import org.superl.exchange.CBitmexTrade.utils.UnixTime;import java.util.List;@Log4jpublic class DbThread extends Thread {    private String threadName;    private List<TradeData> data;    private int start;    private int end;    public DbThread (String threadName, List<TradeData> data, int start, int end){        this.threadName = threadName;        this.data = data;        this.start = start;        this.end = end;    }    public void run() {        List<TradeData> subList = data.subList(start, end);        for(TradeData tradeData : subList) {            long timestampl;            try{                timestampl = Long.parseLong(UnixTime.getUnixTime(tradeData.getTimestamp(),"bitmex"));                tradeData.setTimestampl(timestampl);            }catch (Exception e){                log.error("解析时间戳失败！当前数据："+tradeData.getTimestamp());            }            try{                MysqlDB.insertTrade(tradeData);            }catch (Exception e){                log.error("插入数据失败！当前数据："+tradeData.getTimestamp());            }            //log.info(threadName+"  "+tradeData.getTimestamp());        }        //log.info(threadName+"处理了"+subList.size()+"条！");    }}